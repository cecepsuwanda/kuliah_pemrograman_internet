\section{Geolocation dan Device APIs}

HTML5 menyediakan APIs untuk mengakses fitur device dan informasi lokasi pengguna. Geolocation API memungkinkan aplikasi web untuk mendapatkan lokasi fisik user, sementara Device APIs memberikan akses ke hardware seperti kamera, microphone, dan sensors \cite{mdn-geolocation}. APIs ini membuka kemungkinan untuk aplikasi web yang lebih interaktif dan personal \cite{w3schools-html}.

\subsection{Geolocation API}

Geolocation API menyediakan cara untuk mendapatkan lokasi geografis user:

\begin{itemize}
  \item \textbf{getCurrentPosition()}: Mendapatkan lokasi sekali
  \item \textbf{watchPosition()}: Monitoring lokasi secara continuous
  \item \textbf{Accuracy}: High accuracy dengan GPS atau low accuracy dengan network
  \item \textbf{Privacy}: User consent diperlukan untuk akses lokasi
  \item \textbf{Fallback}: IP-based geolocation untuk browser tanpa support
\end{itemize}

\begin{lstlisting}[caption={Geolocation API Implementation}, basicstyle=\ttfamily\small, frame=single]
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geolocation API Demo</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f8f9fa; }
    .geo-demo { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .btn { background-color: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-right: 10px; }
    .btn:hover { background-color: #0056b3; }
    .btn:disabled { background-color: #6c757d; cursor: not-allowed; }
    .location-info { background-color: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 4px; padding: 15px; margin-top: 15px; }
    .map-container { width: 100%; height: 300px; background-color: #e9ecef; border-radius: 8px; margin-top: 15px; display: flex; align-items: center; justify-content: center; }
    .coordinates { font-family: monospace; background-color: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0; }
    .accuracy-badge { display: inline-block; padding: 5px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; }
    .accuracy-high { background-color: #d4edda; color: #155724; }
    .accuracy-medium { background-color: #fff3cd; color: #856404; }
    .accuracy-low { background-color: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h1>üåç Geolocation API Demo</h1>
  
  <div class="geo-demo">
    <h2>Dapatkan Lokasi Saat Ini</h2>
    
    <div>
      <button class="btn" onclick="getCurrentLocation()">üìç Dapatkan Lokasi</button>
      <button class="btn" onclick="startWatching()">‚ñ∂Ô∏è Mulai Tracking</button>
      <button class="btn" onclick="stopWatching()">‚èπÔ∏è Stop Tracking</button>
      <button class="btn" onclick="clearLocation()">üóëÔ∏è Clear</button>
    </div>
    
    <div id="locationInfo" class="location-info" style="display: none;">
      <h4>Informasi Lokasi:</h4>
      <div class="coordinates">
        <strong>Latitude:</strong> <span id="latitude">-</span><br>
        <strong>Longitude:</strong> <span id="longitude">-</span><br>
        <strong>Altitude:</strong> <span id="altitude">-</span><br>
        <strong>Accuracy:</strong> <span id="accuracy">-</span> 
        <span id="accuracyBadge" class="accuracy-badge">-</span>
      </div>
      
      <div style="margin-top: 15px;">
        <strong>Kecepatan:</strong> <span id="speed">-</span><br>
        <strong>Heading:</strong> <span id="heading">-</span><br>
        <strong>Timestamp:</strong> <span id="timestamp">-</span>
      </div>
    </div>
    
    <div id="mapContainer" class="map-container" style="display: none;">
      <div>
        <h3>üó∫Ô∏è Map Preview</h3>
        <p>Lokasi Anda ditampilkan pada koordinat di atas</p>
        <p><small>(Integrasi dengan Google Maps atau OpenStreetMap dapat ditambahkan)</small></p>
      </div>
    </div>
    
    <div id="trackingInfo" class="location-info" style="display: none; margin-top: 15px;">
      <h4>üìä Tracking Status:</h4>
      <p><strong>Status:</strong> <span id="trackingStatus">Stopped</span></p>
      <p><strong>Update Count:</strong> <span id="updateCount">0</span></p>
    </div>
  </div>
  
  <div class="geo-demo">
    <h2>üó∫Ô∏è Reverse Geocoding (Simulasi)</h2>
    
    <button class="btn" onclick="getAddress()">üè† Dapatkan Alamat</button>
    
    <div id="addressInfo" class="location-info" style="display: none; margin-top: 15px;">
      <h4>Alamat:</h4>
      <p id="addressText">-</p>
    </div>
  </div>
  
  <div class="geo-demo">
    <h2>‚ö†Ô∏è Privacy & Security</h2>
    
    <div class="location-info" style="background-color: #fff3cd; border-color: #ffeaa7;">
      <h4>üõ°Ô∏è Catatan Penting:</h4>
      <ul>
        <li><strong>User Consent:</strong> Browser akan meminta izin user sebelum mengakses lokasi</li>
        <li><strong>HTTPS Required:</strong> Geolocation API hanya bekerja pada secure contexts (HTTPS)</li>
        <li><strong>Privacy:</strong> Lokasi user adalah data sensitif, gunakan dengan bertanggung jawab</li>
        <li><strong>Fallback:</strong> Selalu sediakan fallback untuk browser yang tidak support atau user menolak</li>
      </ul>
    </div>
  </div>
  
  <script>
    let watchId = null;
    let updateCount = 0;
    
    // Get current location
    function getCurrentLocation() {
      if (!navigator.geolocation) {
        alert('Browser Anda tidak mendukung Geolocation API');
        return;
      }
      
      const options = {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      };
      
      navigator.geolocation.getCurrentPosition(
        showPosition,
        showError,
        options
      );
    }
    
    // Show position information
    function showPosition(position) {
      const coords = position.coords;
      
      document.getElementById('latitude').textContent = coords.latitude.toFixed(6);
      document.getElementById('longitude').textContent = coords.longitude.toFixed(6);
      document.getElementById('altitude').textContent = coords.altitude ? coords.altitude.toFixed(2) + ' m' : 'Not available';
      document.getElementById('accuracy').textContent = coords.accuracy.toFixed(0) + ' m';
      document.getElementById('speed').textContent = coords.speed ? coords.speed.toFixed(2) + ' m/s' : 'Not available';
      document.getElementById('heading').textContent = coords.heading ? coords.heading.toFixed(0) + '¬∞' : 'Not available';
      document.getElementById('timestamp').textContent = new Date(position.timestamp).toLocaleString();
      
      // Update accuracy badge
      const badge = document.getElementById('accuracyBadge');
      if (coords.accuracy < 20) {
        badge.className = 'accuracy-badge accuracy-high';
        badge.textContent = 'High Accuracy';
      } else if (coords.accuracy < 100) {
        badge.className = 'accuracy-badge accuracy-medium';
        badge.textContent = 'Medium Accuracy';
      } else {
        badge.className = 'accuracy-badge accuracy-low';
        badge.textContent = 'Low Accuracy';
      }
      
      document.getElementById('locationInfo').style.display = 'block';
      document.getElementById('mapContainer').style.display = 'flex';
      
      updateCount++;
      document.getElementById('updateCount').textContent = updateCount;
    }
    
    // Start watching position
    function startWatching() {
      if (!navigator.geolocation) {
        alert('Browser Anda tidak mendukung Geolocation API');
        return;
      }
      
      if (watchId) {
        alert('Tracking sudah berjalan!');
        return;
      }
      
      const options = {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      };
      
      watchId = navigator.geolocation.watchPosition(
        showPosition,
        showError,
        options
      );
      
      document.getElementById('trackingStatus').textContent = 'Running';
      document.getElementById('trackingInfo').style.display = 'block';
      
      alert('Location tracking dimulai!');
    }
    
    // Stop watching position
    function stopWatching() {
      if (watchId) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
        document.getElementById('trackingStatus').textContent = 'Stopped';
        alert('Location tracking dihentikan!');
      }
    }
    
    // Clear location information
    function clearLocation() {
      document.getElementById('locationInfo').style.display = 'none';
      document.getElementById('mapContainer').style.display = 'none';
      document.getElementById('trackingInfo').style.display = 'none';
      updateCount = 0;
      document.getElementById('updateCount').textContent = updateCount;
      
      if (watchId) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
      }
    }
    
    // Handle errors
    function showError(error) {
      let message = '';
      
      switch(error.code) {
        case error.PERMISSION_DENIED:
          message = 'User menolak permintaan geolocation.';
          break;
        case error.POSITION_UNAVAILABLE:
          message = 'Informasi lokasi tidak tersedia.';
          break;
        case error.TIMEOUT:
          message = 'Request timeout.';
          break;
        default:
          message = 'Error tidak diketahui.';
          break;
      }
      
      alert('Error: ' + message);
    }
    
    // Simulate reverse geocoding
    function getAddress() {
      const latitude = parseFloat(document.getElementById('latitude').textContent);
      const longitude = parseFloat(document.getElementById('longitude').textContent);
      
      if (isNaN(latitude) || isNaN(longitude)) {
        alert('Dapatkan lokasi terlebih dahulu!');
        return;
      }
      
      // Simulasi reverse geocoding (dalam aplikasi nyata, gunakan Google Geocoding API atau OpenCage)
      const mockAddresses = [
        'Jl. Sudirman No. 123, Jakarta Pusat, DKI Jakarta',
        'Jl. Malioboro No. 45, Yogyakarta, DIY',
        'Jl. Diponegoro No. 78, Surabaya, Jawa Timur',
        'Jl. Asia Afrika No. 90, Bandung, Jawa Barat'
      ];
      
      const randomAddress = mockAddresses[Math.floor(Math.random() * mockAddresses.length)];
      
      document.getElementById('addressText').textContent = 
        `${randomAddress}\nKoordinat: ${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;
      document.getElementById('addressInfo').style.display = 'block';
    }
  </script>
</body>
</html>
\end{lstlisting}

\textbf{Hasil di Browser:}
- Tombol untuk mendapatkan lokasi sekali atau continuous tracking
- Display koordinat (latitude, longitude, altitude)
- Accuracy badge (High/Medium/Low) berdasarkan nilai accuracy
- Simulasi reverse geocoding untuk mendapatkan alamat
- Privacy and security notes untuk user awareness

\subsection{Device Orientation dan Motion}

Device Orientation dan Motion APIs memberikan akses ke accelerometer dan gyroscope:

\begin{itemize}
  \item \textbf{DeviceOrientationEvent}: Rotasi device dalam 3D space (alpha, beta, gamma)
  \item \textbf{DeviceMotionEvent}: Acceleration dan rotation rate
  \item \textbf{Use Cases}: Games, virtual reality, step counters, gesture control
  \item \textbf{Permission}: iOS 13+ memerlukan user permission
\end{itemize}

\begin{lstlisting}[caption={Device Orientation dan Motion}, basicstyle=\ttfamily\small, frame=single]
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Device Orientation & Motion</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f8f9fa; }
    .sensor-demo { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .orientation-data { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px; }
    .data-card { background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center; }
    .data-value { font-size: 24px; font-weight: bold; color: #007bff; margin: 10px 0; }
    .data-label { font-size: 14px; color: #6c757d; }
    .device-visual { width: 200px; height: 200px; margin: 20px auto; position: relative; }
    .device-box { width: 100px; height: 60px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); transition: transform 0.1s; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .btn { background-color: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-right: 10px; }
    .btn:hover { background-color: #0056b3; }
    .status { padding: 10px; border-radius: 4px; margin-top: 15px; }
    .status.active { background-color: #d4edda; color: #155724; }
    .status.inactive { background-color: #f8d7da; color: #721c24; }
  </style>
</head>
<body>
  <h1>üì± Device Orientation & Motion</h1>
  
  <div class="sensor-demo">
    <h2>üß≠ Device Orientation</h2>
    
    <div>
      <button class="btn" onclick="startOrientation()">‚ñ∂Ô∏è Start Orientation</button>
      <button class="btn" onclick="stopOrientation()">‚èπÔ∏è Stop Orientation</button>
    </div>
    
    <div class="device-visual">
      <div class="device-box" id="deviceBox"></div>
    </div>
    
    <div class="orientation-data">
      <div class="data-card">
        <div class="data-label">Alpha (Z-axis)</div>
        <div class="data-value" id="alpha">0¬∞</div>
        <small>Rotation around z-axis</small>
      </div>
      
      <div class="data-card">
        <div class="data-label">Beta (X-axis)</div>
        <div class="data-value" id="beta">0¬∞</div>
        <small>Front-to-back tilt</small>
      </div>
      
      <div class="data-card">
        <div class="data-label">Gamma (Y-axis)</div>
        <div class="data-value" id="gamma">0¬∞</div>
        <small>Left-to-right tilt</small>
      </div>
    </div>
    
    <div id="orientationStatus" class="status inactive">
      Orientation tracking: Inactive
    </div>
  </div>
  
  <div class="sensor-demo">
    <h2>üèÉ Device Motion (Accelerometer)</h2>
    
    <div>
      <button class="btn" onclick="startMotion()">‚ñ∂Ô∏è Start Motion</button>
      <button class="btn" onclick="stopMotion()">‚èπÔ∏è Stop Motion</button>
    </div>
    
    <div class="orientation-data" style="margin-top: 15px;">
      <div class="data-card">
        <div class="data-label">Acceleration X</div>
        <div class="data-value" id="accelX">0</div>
        <small>m/s¬≤</small>
      </div>
      
      <div class="data-card">
        <div class="data-label">Acceleration Y</div>
        <div class="data-value" id="accelY">0</div>
        <small>m/s¬≤</small>
      </div>
      
      <div class="data-card">
        <div class="data-label">Acceleration Z</div>
        <div class="data-value" id="accelZ">0</div>
        <small>m/s¬≤</small>
      </div>
      
      <div class="data-card">
        <div class="data-label">Total Acceleration</div>
        <div class="data-value" id="totalAccel">0</div>
        <small>m/s¬≤</small>
      </div>
    </div>
    
    <div id="motionStatus" class="status inactive" style="margin-top: 15px;">
      Motion tracking: Inactive
    </div>
  </div>
  
  <script>
    let orientationListener = null;
    let motionListener = null;
    
    // Device Orientation
    function startOrientation() {
      if (window.DeviceOrientationEvent) {
        orientationListener = handleOrientation;
        window.addEventListener('deviceorientation', handleOrientation);
        
        document.getElementById('orientationStatus').className = 'status active';
        document.getElementById('orientationStatus').textContent = 'Orientation tracking: Active';
      } else {
        alert('DeviceOrientationEvent tidak didukung di browser ini');
      }
    }
    
    function stopOrientation() {
      if (orientationListener) {
        window.removeEventListener('deviceorientation', handleOrientation);
        orientationListener = null;
        
        document.getElementById('orientationStatus').className = 'status inactive';
        document.getElementById('orientationStatus').textContent = 'Orientation tracking: Inactive';
      }
    }
    
    function handleOrientation(event) {
      const alpha = event.alpha || 0;
      const beta = event.beta || 0;
      const gamma = event.gamma || 0;
      
      document.getElementById('alpha').textContent = alpha.toFixed(1) + '¬∞';
      document.getElementById('beta').textContent = beta.toFixed(1) + '¬∞';
      document.getElementById('gamma').textContent = gamma.toFixed(1) + '¬∞';
      
      // Visual feedback dengan rotate device box
      const deviceBox = document.getElementById('deviceBox');
      deviceBox.style.transform = `translate(-50%, -50%) rotateX(${-beta}deg) rotateY(${gamma}deg) rotateZ(${alpha}deg)`;
    }
    
    // Device Motion
    function startMotion() {
      if (window.DeviceMotionEvent) {
        motionListener = handleMotion;
        window.addEventListener('devicemotion', handleMotion);
        
        document.getElementById('motionStatus').className = 'status active';
        document.getElementById('motionStatus').textContent = 'Motion tracking: Active';
      } else {
        alert('DeviceMotionEvent tidak didukung di browser ini');
      }
    }
    
    function stopMotion() {
      if (motionListener) {
        window.removeEventListener('devicemotion', handleMotion);
        motionListener = null;
        
        document.getElementById('motionStatus').className = 'status inactive';
        document.getElementById('motionStatus').textContent = 'Motion tracking: Inactive';
      }
    }
    
    function handleMotion(event) {
      const acceleration = event.accelerationIncludingGravity;
      
      if (acceleration) {
        const x = acceleration.x || 0;
        const y = acceleration.y || 0;
        const z = acceleration.z || 0;
        const total = Math.sqrt(x*x + y*y + z*z);
        
        document.getElementById('accelX').textContent = x.toFixed(2);
        document.getElementById('accelY').textContent = y.toFixed(2);
        document.getElementById('accelZ').textContent = z.toFixed(2);
        document.getElementById('totalAccel').textContent = total.toFixed(2);
      }
    }
  </script>
</body>
</html>
\end{lstlisting}

\textbf{Hasil di Browser:}
- Visualisasi device orientation dengan 3D box yang berputar
- Display alpha, beta, gamma rotation values secara real-time
- Accelerometer data untuk x, y, z acceleration
- Tombol start/stop untuk mengontrol sensor monitoring
- Device motion tracking untuk gesture control

\subsection{Media Devices API (Camera & Microphone)}

Media Devices API memungkinkan akses ke camera dan microphone:

\begin{itemize}
  \item \textbf{getUserMedia()}: Akses camera dan microphone streams
  \item \textbf{Constraints}: Resolusi, facing mode, frame rate
  \item \textbf{Permissions}: User consent diperlukan untuk akses media
  \item \textbf{Recording}: MediaRecorder API untuk merekam audio/video
\end{itemize}

\begin{lstlisting}[caption={Media Devices API}, basicstyle=\ttfamily\small, frame=single]
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Media Devices API</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f8f9fa; }
    .media-demo { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .video-container { position: relative; background-color: #000; border-radius: 8px; overflow: hidden; margin-bottom: 15px; }
    .video-preview { width: 100%; height: 300px; object-fit: cover; display: block; }
    .camera-controls { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
    .btn { background-color: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
    .btn:hover { background-color: #0056b3; }
    .btn:disabled { background-color: #6c757d; cursor: not-allowed; }
    .btn.record { background-color: #dc3545; }
    .btn.record:hover { background-color: #c82333; }
    .btn.stop { background-color: #6c757d; }
    .recording-indicator { display: none; background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 4px; font-size: 12px; animation: blink 1s infinite; }
    @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0; } }
    .captured-photos { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 15px; }
    .photo-item { position: relative; border-radius: 4px; overflow: hidden; }
    .photo-item img { width: 100%; height: 100px; object-fit: cover; }
    .audio-visualizer { width: 100%; height: 100px; background-color: #000; border-radius: 8px; margin-top: 15px; }
  </style>
</head>
<body>
  <h1>üì∑ Media Devices API</h1>
  
  <div class="media-demo">
    <h2>üìπ Camera Access</h2>
    
    <div class="camera-controls">
      <button class="btn" onclick="startCamera()">‚ñ∂Ô∏è Start Camera</button>
      <button class="btn" onclick="stopCamera()">‚èπÔ∏è Stop Camera</button>
      <button class="btn" onclick="switchCamera()">üîÑ Switch Camera</button>
      <button class="btn record" onclick="takePhoto()">üì∏ Take Photo</button>
      <span class="recording-indicator" id="recordingIndicator">üî¥ Recording</span>
    </div>
    
    <div class="video-container">
      <video id="videoPreview" class="video-preview" autoplay muted playsinline></video>
    </div>
    
    <canvas id="photoCanvas" style="display: none;"></canvas>
    
    <div id="capturedPhotos" class="captured-photos" style="display: none;">
      <h4>Captured Photos:</h4>
    </div>
  </div>
  
  <div class="media-demo">
    <h2>üé§ Microphone Access</h2>
    
    <div class="camera-controls">
      <button class="btn" onclick="startAudio()">‚ñ∂Ô∏è Start Audio</button>
      <button class="btn" onclick="stopAudio()">‚èπÔ∏è Stop Audio</button>
    </div>
    
    <canvas id="audioVisualizer" class="audio-visualizer"></canvas>
    
    <div id="audioStatus" style="margin-top: 15px; padding: 10px; background-color: #e9ecef; border-radius: 4px;">
      Audio Status: Stopped
    </div>
  </div>
  
  <div class="media-demo">
    <h2>‚ö†Ô∏è Privacy & Permissions</h2>
    
    <div style="background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 15px;">
      <h4>üîí Important Notes:</h4>
      <ul>
        <li><strong>User Consent:</strong> Browser akan meminta izin sebelum mengakses camera/microphone</li>
        <li><strong>HTTPS Required:</strong> Media Devices API hanya bekerja pada secure contexts</li>
        <li><strong>Privacy Indicators:</strong> Browser akan menampilkan indicator saat camera/microphone aktif</li>
        <li><strong>Permission Management:</strong> User dapat revoke permission kapan saja</li>
      </ul>
    </div>
  </div>
  
  <script>
    let stream = null;
    let audioContext = null;
    let analyser = null;
    let microphone = null;
    let currentFacing = 'user'; // 'user' or 'environment'
    let capturedPhotos = [];
    
    // Start camera
    async function startCamera() {
      try {
        const constraints = {
          video: {
            facingMode: currentFacing,
            width: { ideal: 1280 },
            height: { ideal: 720 }
          },
          audio: false
        };
        
        stream = await navigator.mediaDevices.getUserMedia(constraints);
        const video = document.getElementById('videoPreview');
        video.srcObject = stream;
        
      } catch (error) {
        alert('Error accessing camera: ' + error.message);
      }
    }
    
    // Stop camera
    function stopCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
        document.getElementById('videoPreview').srcObject = null;
      }
    }
    
    // Switch camera (front/rear)
    async function switchCamera() {
      stopCamera();
      currentFacing = currentFacing === 'user' ? 'environment' : 'user';
      await startCamera();
    }
    
    // Take photo
    function takePhoto() {
      const video = document.getElementById('videoPreview');
      const canvas = document.getElementById('photoCanvas');
      const photosContainer = document.getElementById('capturedPhotos');
      
      if (!video.srcObject) {
        alert('Camera tidak aktif!');
        return;
      }
      
      // Set canvas dimensions
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      
      // Draw video frame to canvas
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      
      // Create photo item
      const photoData = canvas.toDataURL('image/jpeg');
      const photoItem = document.createElement('div');
      photoItem.className = 'photo-item';
      photoItem.innerHTML = `<img src="${photoData}" alt="Captured photo">`;
      
      photosContainer.appendChild(photoItem);
      photosContainer.style.display = 'grid';
      
      capturedPhotos.push(photoData);
    }
    
    // Start audio with visualization
    async function startAudio() {
      try {
        const audioStream = await navigator.mediaDevices.getUserMedia({ audio: true, video: false });
        
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        microphone = audioContext.createMediaStreamSource(audioStream);
        microphone.connect(analyser);
        
        analyser.fftSize = 256;
        const bufferLength = analyser.frequencyBinCount;
        const dataArray = new Uint8Array(bufferLength);
        
        const canvas = document.getElementById('audioVisualizer');
        const canvasCtx = canvas.getContext('2d');
        
        // Resize canvas
        canvas.width = canvas.offsetWidth;
        canvas.height = canvas.offsetHeight;
        
        function draw() {
          requestAnimationFrame(draw);
          
          analyser.getByteFrequencyData(dataArray);
          
          canvasCtx.fillStyle = 'rgb(0, 0, 0)';
          canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
          
          const barWidth = (canvas.width / bufferLength) * 2.5;
          let barHeight;
          let x = 0;
          
          for (let i = 0; i < bufferLength; i++) {
            barHeight = dataArray[i] / 2;
            
            canvasCtx.fillStyle = `rgb(${barHeight + 100}, 50, 50)`;
            canvasCtx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
            
            x += barWidth + 1;
          }
        }
        
        draw();
        
        document.getElementById('audioStatus').textContent = 'Audio Status: Active - Microphone listening';
        document.getElementById('audioStatus').style.backgroundColor = '#d4edda';
        document.getElementById('audioStatus').style.color = '#155724';
        
      } catch (error) {
        alert('Error accessing microphone: ' + error.message);
      }
    }
    
    // Stop audio
    function stopAudio() {
      if (audioContext) {
        audioContext.close();
        audioContext = null;
        analyser = null;
        microphone = null;
      }
      
      // Clear canvas
      const canvas = document.getElementById('audioVisualizer');
      const canvasCtx = canvas.getContext('2d');
      canvasCtx.fillStyle = 'rgb(0, 0, 0)';
      canvasCtx.fillRect(0, 0, canvas.width, canvas.height);
      
      document.getElementById('audioStatus').textContent = 'Audio Status: Stopped';
      document.getElementById('audioStatus').style.backgroundColor = '#e9ecef';
      document.getElementById('audioStatus').style.color = '#333';
    }
  </script>
</body>
</html>
\end{lstlisting}

\textbf{Hasil di Browser:}
- Camera preview dengan video element
- Tombol untuk start/stop camera dan switch front/rear camera
- Take photo functionality dengan canvas capture
- Photo gallery untuk menampilkan captured photos
- Audio visualizer dengan frequency bar chart
- Privacy notes untuk user awareness

Geolocation dan Device APIs memungkinkan aplikasi web untuk mengakses fitur hardware dan informasi lokasi yang sebelumnya hanya tersedia untuk native applications \cite{w3schools-html}. Dengan permission-based access dan privacy controls, APIs ini menyediakan fondasi untuk aplikasi web yang lebih personal dan interaktif \cite{mdn-geolocation}.
